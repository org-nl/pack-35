document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".mobile-menu-toggle"),t=document.querySelector(".main-navigation");e&&e.addEventListener("click",(function(){t.classList.toggle("active"),document.body.classList.toggle("menu-open")}));const o=document.getElementById("scroll-to-top");o&&(window.addEventListener("scroll",(function(){window.pageYOffset>300?document.querySelector(".back-to-top").classList.add("show"):document.querySelector(".back-to-top").classList.remove("show")})),o.addEventListener("click",(function(e){e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})));const n=document.getElementById("toc-sidebar"),c=document.getElementById("toc-open-btn"),s=document.getElementById("toc-close-btn"),i=document.querySelectorAll(".toc-link");if(c&&s&&n){function r(e){e&&e.preventDefault(),n.classList.remove("open"),document.body.classList.remove("toc-open")}c.addEventListener("click",(function(e){e&&e.preventDefault(),n.classList.add("open"),document.body.classList.add("toc-open")})),s.addEventListener("click",r),document.addEventListener("click",(function(e){n.classList.contains("open")&&(n.contains(e.target)||c.contains(e.target)||e.target===c||r())})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&n.classList.contains("open")&&r()})),i.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();const t=this.getAttribute("href").substring(1),o=document.getElementById(t);o&&(r(),setTimeout((function(){const e=o.getBoundingClientRect().top+window.pageYOffset-120;window.scrollTo({top:e,behavior:"smooth"})}),300))}))}))}document.querySelectorAll('a[href^="#"]:not(.toc-link)').forEach(e=>{e.addEventListener("click",(function(e){const o=this.getAttribute("href");if("#"===o||!o||this.classList.contains("toc-close"))return;const n=document.querySelector(o);n&&(e.preventDefault(),t&&t.classList.contains("active")&&(t.classList.remove("active"),document.body.classList.remove("menu-open")),window.scrollTo({top:n.offsetTop-80,behavior:"smooth"}))}))});const l=document.querySelectorAll(".comment-reply"),a=document.querySelector(".comment-form"),d=document.querySelector(".comment-form-container");l.length&&a&&l.forEach(e=>{e.addEventListener("click",(function(e){e.preventDefault();const t=this.closest(".comment-item").querySelector(".comment-author").textContent.split(" ")[0];let o=d.querySelector(".reply-notice");o||(o=document.createElement("div"),o.className="reply-notice",d.insertBefore(o,d.firstChild)),o.innerHTML=`\n                    <p>Replying to <strong>${t}</strong></p>\n                    <a href="#" class="cancel-reply">Cancel reply</a>\n                `,window.scrollTo({top:d.offsetTop-100,behavior:"smooth"}),a.querySelector("textarea").focus();const n=o.querySelector(".cancel-reply");n&&n.addEventListener("click",(function(e){e.preventDefault(),o.remove()}))}))}),a&&a.addEventListener("submit",(function(e){e.preventDefault();const t=this.querySelector("#comment").value,o=this.querySelector("#author").value,n=this.querySelector("#email").value;if(!t||!o||!n)return void alert("Please fill in all required fields");const c=document.createElement("div");c.className="comment-success",c.innerHTML="<p>Thank you for your comment! It is awaiting moderation.</p>",this.parentNode.appendChild(c),this.reset();const s=d.querySelector(".reply-notice");s&&s.remove(),setTimeout(()=>{c.remove()},5e3)}));const u=()=>{document.querySelectorAll("section").forEach(e=>{e.getBoundingClientRect().top<.75*window.innerHeight&&e.classList.add("section-visible")})};window.addEventListener("load",u),window.addEventListener("scroll",u)}));